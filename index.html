<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
<title>持ち物チェッカー</title>
<meta name="description" content="忘れ物防止のためのシンプルな持ち物チェックアプリ。スマホ最適化UI。">

<style>
  :root { color-scheme: light dark; }
  body {
    margin: 0; padding: 0; font-family: system-ui, sans-serif;
    background: Canvas; color: CanvasText;
  }
  header {
    position: sticky; top: 0;
    background: color-mix(in oklab, Canvas 90%, CanvasText 5%);
    padding: 12px; font-size: 1.2rem; font-weight: bold;
    text-align: center; border-bottom: 1px solid #ccc;
  }

  /* 入力エリア */
  .row { display: flex; gap: 8px; padding: 10px; }
  .row input {
    flex: 1; padding: 14px; font-size: 1rem;
    border-radius: 12px; border: 1px solid #ccc;
  }
  .row button {
    padding: 12px 16px; border: none; border-radius: 12px;
    background: #007aff; color: white; font-size: 1rem; font-weight: bold;
  }

  /* 操作ボタン */
  .bar {
    display: flex; gap: 8px; flex-wrap: wrap;
    padding: 10px; justify-content: space-between;
  }
  .bar button {
    flex: 1; padding: 14px; font-size: .95rem;
    border: none; border-radius: 12px; font-weight: bold;
    background: #eee; color: #333;
  }

  /* リスト */
  ul { list-style: none; margin: 0; padding: 10px; }
  li {
    background: color-mix(in oklab, Canvas 96%, CanvasText 3%);
    border-radius: 12px; margin-bottom: 10px; padding: 12px;
    display: flex; justify-content: space-between; align-items: center;
  }
  li label { display: flex; align-items: center; gap: 10px; flex: 1; }
  li input[type=checkbox] { width: 22px; height: 22px; }
  li .name { font-size: 1rem; }
  li.checked .name { text-decoration: line-through; opacity: 0.6; }

  .actions button {
    margin-left: 6px; padding: 6px 10px; font-size: .9rem;
    border-radius: 10px; border: 1px solid #aaa; background: white;
  }

  /* フッター */
  footer {
    position: sticky; bottom: 0; background: #f9f9f9;
    border-top: 1px solid #ccc; text-align: center;
    padding: 10px; font-size: 0.8rem; opacity: 0.7;
  }
</style>
</head>
<body>
  <header>🧳 持ち物チェッカー</header>

  <div class="row">
    <input id="newItem" type="text" placeholder="アイテムを入力…" />
    <button id="addBtn">追加</button>
  </div>

  <div class="bar">
    <button id="uncheckAllBtn">全解除</button>
    <button id="clearCheckedBtn">✅削除</button>
  </div>

  <ul id="list"></ul>

  <footer>保存先：この端末 / 最終更新 <span id="ts">–</span></footer>

<script>
const LS_KEY = 'packlist_v3';
let state = { items: [], updatedAt: Date.now() };

const $ = (sel)=>document.querySelector(sel);
const listEl = $('#list'), tsEl = $('#ts'), inputEl = $('#newItem');

function uid(){ return Date.now().toString(36)+Math.random().toString(36).slice(2); }
function fmtTime(t){ const d=new Date(t);return `${d.getMonth()+1}/${d.getDate()} ${d.getHours()}:${String(d.getMinutes()).padStart(2,'0')}`;}

function save(){ state.updatedAt=Date.now(); localStorage.setItem(LS_KEY,JSON.stringify(state)); tsEl.textContent=fmtTime(state.updatedAt);}
function load(){ try{const raw=localStorage.getItem(LS_KEY);if(raw){state=JSON.parse(raw)||state;}}catch(e){} }

function render(){
  listEl.innerHTML='';
  state.items.forEach(item=>{
    const li=document.createElement('li');
    if(item.checked) li.classList.add('checked');

    const label=document.createElement('label');
    const cb=document.createElement('input');
    cb.type='checkbox'; cb.checked=item.checked;
    cb.onchange=()=>{item.checked=cb.checked; save(); render();};
    const span=document.createElement('span'); span.className='name'; span.textContent=item.name;

    label.appendChild(cb); label.appendChild(span);

    const actions=document.createElement('div'); actions.className='actions';
    const edit=document.createElement('button'); edit.textContent='✏️';
    edit.onclick=()=>{const v=prompt('編集',item.name);if(v){item.name=v.trim();save();render();}};
    const del=document.createElement('button'); del.textContent='🗑';
    del.onclick=()=>{if(confirm(`${item.name}を削除しますか？`)){state.items=state.items.filter(x=>x.id!==item.id);save();render();}};
    actions.appendChild(edit);actions.appendChild(del);

    li.appendChild(label); li.appendChild(actions);
    listEl.appendChild(li);
  });
  tsEl.textContent=fmtTime(state.updatedAt);
}

$('#addBtn').onclick=()=>{const v=inputEl.value.trim(); if(v){state.items.push({id:uid(),name:v,checked:false}); inputEl.value=''; save(); render();}};
inputEl.onkeydown=e=>{if(e.key==='Enter') $('#addBtn').click();};

$('#uncheckAllBtn').onclick=()=>{state.items.forEach(i=>i.checked=false); save(); render();};
$('#clearCheckedBtn').onclick=()=>{state.items=state.items.filter(i=>!i.checked); save(); render();};

load(); render();
</script>
</body>
</html>
