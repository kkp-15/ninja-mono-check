<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
<title>æŒã¡ç‰©ãƒã‚§ãƒƒã‚«ãƒ¼ï¼ˆã‚·ãƒ³ãƒ—ãƒ«ï¼‰</title>
<meta name="description" content="å¿˜ã‚Œç‰©é˜²æ­¢ã®ãŸã‚ã®ã‚·ãƒ³ãƒ—ãƒ«ãªæŒã¡ç‰©ãƒã‚§ãƒƒã‚¯ã‚¢ãƒ—ãƒªã€‚ç™»éŒ²ãƒ»ç·¨é›†ãƒ»å‰Šé™¤ã€ãƒã‚§ãƒƒã‚¯ã€å…¨è§£é™¤ã€ç«¯æœ«ä¿å­˜ã«å¯¾å¿œã€‚">

<style>
  /* ---- ãƒ™ãƒ¼ã‚¹ ---- */
  :root { color-scheme: light dark; }
  html,body{margin:0;padding:0;font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Hiragino Kaku Gothic ProN", "Noto Sans JP", sans-serif;}
  body{max-width:720px;margin:auto;padding:16px 14px 80px;background:Canvas;color:CanvasText;}

  h1{font-size:1.25rem;margin:0 0 12px;}
  .sub{font-size:.9rem;opacity:.7;margin:0 0 14px;}

  /* ---- å…¥åŠ›è¡Œ ---- */
  .row{display:flex;gap:8px;align-items:center;margin:10px 0 14px;}
  input[type="text"]{
    flex:1;padding:12px;border:1px solid color-mix(in oklab, CanvasText 20%, transparent);
    border-radius:12px;font-size:16px;background:Field;color:FieldText;
  }
  button{
    padding:10px 14px;border-radius:12px;border:1px solid color-mix(in oklab, CanvasText 20%, transparent);
    background:ButtonFace;color:ButtonText;font-weight:600;cursor:pointer;
  }
  button:active{transform: translateY(1px);}

  /* ---- ãƒãƒ¼ ---- */
  .bar{display:flex;gap:8px;flex-wrap:wrap;margin:6px 0 12px;}
  .bar button{flex:1}

  /* ---- ãƒªã‚¹ãƒˆ ---- */
  ul{list-style:none;margin:0;padding:0;border:1px solid color-mix(in oklab, CanvasText 20%, transparent);border-radius:14px;overflow:hidden}
  li{
    display:flex;align-items:center;gap:10px;padding:12px 12px;border-top:1px solid color-mix(in oklab, CanvasText 12%, transparent);
    background:Canvas;color:CanvasText;
  }
  li:first-child{border-top:none;}
  li label{display:flex;align-items:center;gap:10px;flex:1;cursor:pointer;}
  li .name{line-height:1.35;}
  li.checked .name{opacity:.6;text-decoration: line-through;}
  .actions{display:flex;gap:6px;}
  .iconbtn{
    border:1px solid color-mix(in oklab, CanvasText 20%, transparent);background:transparent;
    padding:6px 8px;border-radius:10px;font-size:.95rem;min-width:40px;
  }

  /* ---- ãƒ•ãƒƒã‚¿ãƒ¼ ---- */
  .foot{position:fixed;left:0;right:0;bottom:0;padding:10px 14px;background:color-mix(in oklab, Canvas 85%, CanvasText 0%);
    border-top:1px solid color-mix(in oklab, CanvasText 20%, transparent);}
  .foot small{opacity:.7}
</style>
</head>
<body>
  <h1>ğŸ§³ æŒã¡ç‰©ãƒã‚§ãƒƒã‚«ãƒ¼</h1>
  <p class="sub">ç™»éŒ²â†’ãƒã‚§ãƒƒã‚¯âœ…ã€‚æ¬¡ã®ãƒã‚§ãƒƒã‚¯ç”¨ã«ã€Œå…¨è§£é™¤ï¼ˆãƒªã‚»ãƒƒãƒˆï¼‰ã€ã‚ã‚Šã€‚ç«¯æœ«ã«è‡ªå‹•ä¿å­˜ã•ã‚Œã¾ã™ã€‚</p>

  <!-- è¿½åŠ è¡Œ -->
  <div class="row">
    <input id="newItem" type="text" placeholder="ä¾‹ï¼‰ã‚¹ãƒãƒ›å……é›»å™¨ã€è²¡å¸ƒã€å®¶ã®éµâ€¦" inputmode="text" />
    <button id="addBtn">è¿½åŠ </button>
  </div>

  <!-- æ“ä½œãƒãƒ¼ -->
  <div class="bar">
    <button id="checkAllBtn">ã™ã¹ã¦âœ…</button>
    <button id="uncheckAllBtn">å…¨è§£é™¤ï¼ˆãƒªã‚»ãƒƒãƒˆï¼‰</button>
    <button id="clearCheckedBtn">âœ…æ¸ˆã¿ã‚’å‰Šé™¤</button>
  </div>

  <!-- ãƒªã‚¹ãƒˆ -->
  <ul id="list"></ul>

  <div class="foot">
    <small>ä¿å­˜å…ˆï¼šã“ã®ç«¯æœ«ï¼ˆlocalStorageï¼‰ / æœ€çµ‚æ›´æ–° <span id="ts">â€“</span></small>
  </div>

<script>
/* ===============================
   æŒã¡ç‰©ãƒã‚§ãƒƒã‚«ãƒ¼ï¼ˆã‚·ãƒ³ãƒ—ãƒ«å®Ÿè£…ï¼‰
   - è¿½åŠ  / ç·¨é›† / å‰Šé™¤
   - ãƒã‚§ãƒƒã‚¯ / å…¨ãƒã‚§ãƒƒã‚¯ / å…¨è§£é™¤
   - âœ…æ¸ˆã¿ä¸€æ‹¬å‰Šé™¤ï¼ˆä»»æ„ï¼‰
   - ç«¯æœ«ä¿å­˜ï¼ˆlocalStorageï¼‰
   =============================== */

const LS_KEY = 'packlist_v1';

let state = {
  items: [],        // {id, name, checked}
  updatedAt: Date.now()
};

/* ---------- ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ ---------- */
const $ = (sel)=>document.querySelector(sel);
const listEl = $('#list');
const tsEl = $('#ts');
const inputEl = $('#newItem');
const addBtn = $('#addBtn');
const checkAllBtn = $('#checkAllBtn');
const uncheckAllBtn = $('#uncheckAllBtn');
const clearCheckedBtn = $('#clearCheckedBtn');

function uid(){ return Date.now().toString(36) + Math.random().toString(36).slice(2,6); }

function fmtTime(t){
  const d = new Date(t);
  const y = d.getFullYear();
  const m = String(d.getMonth()+1).padStart(2,'0');
  const day = String(d.getDate()).padStart(2,'0');
  const hh = String(d.getHours()).padStart(2,'0');
  const mm = String(d.getMinutes()).padStart(2,'0');
  return `${y}/${m}/${day} ${hh}:${mm}`;
}

/* ---------- æ°¸ç¶šåŒ– ---------- */
function save(){
  state.updatedAt = Date.now();
  localStorage.setItem(LS_KEY, JSON.stringify(state));
  tsEl.textContent = fmtTime(state.updatedAt);
}

function load(){
  try{
    const raw = localStorage.getItem(LS_KEY);
    if(raw){
      const obj = JSON.parse(raw);
      if(Array.isArray(obj.items)) state.items = obj.items;
      if(obj.updatedAt) state.updatedAt = obj.updatedAt;
    }
  }catch(e){ console.warn('load failed', e); }
}

/* ---------- æç”» ---------- */
function render(){
  listEl.innerHTML = '';
  state.items.forEach(item=>{
    const li = document.createElement('li');
    if(item.checked) li.classList.add('checked');

    const label = document.createElement('label');
    label.setAttribute('for', `cb-${item.id}`);

    const cb = document.createElement('input');
    cb.type = 'checkbox';
    cb.id = `cb-${item.id}`;
    cb.checked = !!item.checked;
    cb.addEventListener('change', ()=>{
      item.checked = cb.checked;
      save(); render();
    });

    const name = document.createElement('span');
    name.className = 'name';
    name.textContent = item.name;

    label.appendChild(cb);
    label.appendChild(name);

    const actions = document.createElement('div');
    actions.className = 'actions';

    // ç·¨é›†
    const editBtn = document.createElement('button');
    editBtn.className = 'iconbtn';
    editBtn.textContent = 'âœï¸ç·¨é›†';
    editBtn.addEventListener('click', ()=>{
      const v = prompt('åå‰ã‚’ç·¨é›†', item.name);
      if(v === null) return; // ã‚­ãƒ£ãƒ³ã‚»ãƒ«
      const trimmed = v.trim();
      if(!trimmed) return alert('ç©ºç™½ã¯ç™»éŒ²ã§ãã¾ã›ã‚“');
      item.name = trimmed;
      save(); render();
    });

    // å‰Šé™¤
    const delBtn = document.createElement('button');
    delBtn.className = 'iconbtn';
    delBtn.textContent = 'ğŸ—‘å‰Šé™¤';
    delBtn.addEventListener('click', ()=>{
      if(!confirm(`ã€Œ${item.name}ã€ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ`)) return;
      state.items = state.items.filter(x=>x.id !== item.id);
      save(); render();
    });

    actions.appendChild(editBtn);
    actions.appendChild(delBtn);

    li.appendChild(label);
    li.appendChild(actions);
    listEl.appendChild(li);
  });

  tsEl.textContent = fmtTime(state.updatedAt);
}

/* ---------- è¿½åŠ ç³» ---------- */
function addItem(name){
  const v = (name ?? inputEl.value).trim();
  if(!v) return;
  state.items.push({id: uid(), name: v, checked:false});
  inputEl.value = '';
  save(); render();
}

addBtn.addEventListener('click', ()=> addItem());
inputEl.addEventListener('keydown', (e)=>{
  if(e.key === 'Enter') addItem();
});

/* ---------- ãƒãƒ¼æ“ä½œ ---------- */
checkAllBtn.addEventListener('click', ()=>{
  state.items.forEach(i=>i.checked = true);
  save(); render();
});

uncheckAllBtn.addEventListener('click', ()=>{
  // æ¬¡ã®ãƒã‚§ãƒƒã‚¯ç”¨ï¼šãƒã‚§ãƒƒã‚¯ã ã‘å…¨è§£é™¤ï¼ˆãƒªã‚»ãƒƒãƒˆï¼‰
  state.items.forEach(i=>i.checked = false);
  save(); render();
});

clearCheckedBtn.addEventListener('click', ()=>{
  // âœ…æ¸ˆã¿ã‚’ä¸€æ‹¬å‰Šé™¤ï¼ˆä»»æ„ï¼‰
  if(!state.items.some(i=>i.checked)) return alert('âœ…æ¸ˆã¿ã®é …ç›®ã¯ã‚ã‚Šã¾ã›ã‚“');
  if(!confirm('âœ…æ¸ˆã¿ã®é …ç›®ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ')) return;
  state.items = state.items.filter(i=>!i.checked);
  save(); render();
});

/* ---------- èµ·å‹• ---------- */
load();
render();
</script>
</body>
</html>
